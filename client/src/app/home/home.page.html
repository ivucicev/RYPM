<ion-header>
    <ion-toolbar>
        <ion-title>{{'workout' | translate}}</ion-title>
        <ion-buttons slot="end">
            <ion-button (click)="openNewWorkout()">
                <ion-icon name="add-circle-outline"></ion-icon>
            </ion-button>
        </ion-buttons>
    </ion-toolbar>
    <ion-row class="segment-toolbar ion-padding-x">
        <ion-segment mode="ios" [(ngModel)]="tab" lines="none">
            <ion-segment-button mode="ios" value="programs">
                <ion-label>
                    {{'programs' | translate}}
                </ion-label>
            </ion-segment-button>
            <ion-segment-button mode="ios" value="templates">
                <ion-label>
                    {{'templates' | translate}}
                </ion-label>
            </ion-segment-button>
        </ion-segment>
        <div [ngSwitch]="tab" [style.margin-left]="'auto'">
            <ng-container *ngSwitchCase="'programs'">
                <ion-button expand="block" fill="clear" size="small" color="primary" (click)="openNewProgram()">
                    <ion-icon slot="start" name="layers-outline"></ion-icon>
                    {{ 'add_program' | translate }}
                </ion-button>
            </ng-container>
            <ng-container *ngSwitchCase="'templates'">
                <ion-button expand="block" fill="clear" color="primary" size="small" (click)="openNewTemplate()">
                    <ion-icon slot="start" name="shapes-outline"></ion-icon>
                    {{ 'add_template' | translate }}
                </ion-button>
            </ng-container>
        </div>
    </ion-row>



    <!-- <ion-toolbar>
        <ion-title><img class="light-invert" src="assets/images/logo.png"></ion-title>
    </ion-toolbar> -->

</ion-header>

<ion-content class="bg_color ion-padding-x" fullscreen fixed-slot-placement="before">
    <div class="tab_content" [ngSwitch]="tab">
        <ng-container *ngSwitchCase="'programs'">
            <ion-list>
                @for (program of programs; track program.id) {
                <ion-item-sliding>
                    <ion-item [button]="true" (click)="presentProgramActionSheet(program)">
                        <ion-label>
                            <div>
                                <h2>{{ program.name }}</h2>
                                <span class="duration">
                                    <ion-icon name="time-outline" size="small"></ion-icon>
                                    {{ program.duration || 'N/A' }} {{ 'weeks' | translate }}
                                </span>
                            </div>
                            <ion-note>{{ program.description || ('no_description' | translate) }}</ion-note>
                            @if (program.tags?.length > 0) {
                            <div class="tag-container">
                                @for (tag of program.tags; track $index) {
                                <ion-chip color="primary" size="small">{{ tag }}</ion-chip>
                                }
                            </div>
                            }
                        </ion-label>
                    </ion-item>
                    <ion-item-options side="start">
                        <ion-item-option color="primary" (click)="presentAssignProgramPopover(program)">
                            <ion-icon slot="icon-only" name="person-add"></ion-icon>
                        </ion-item-option>
                    </ion-item-options>

                    <ion-item-options side="end">
                        <ion-item-option color="danger" (click)="deleteProgram(program.id)">
                            <ion-icon slot="icon-only" name="trash"></ion-icon>
                        </ion-item-option>
                    </ion-item-options>
                </ion-item-sliding>
                <!-- <ion-item-sliding>
                    <ion-card>
                        <ion-item [button]="true" (click)="presentProgramActionSheet(program)">
                            <ion-label>
                                <div>
                                    <h2>{{ program.name }}</h2>
                                    <span class="duration">
                                        <ion-icon name="time-outline" size="small"></ion-icon>
                                        {{ program.duration || 'N/A' }} {{ 'weeks' | translate }}
                                    </span>
                                </div>
                                <ion-note>{{ program.description || ('no_description' | translate) }}</ion-note>
                                @if (program.tags?.length > 0) {
                                <div class="tag-container">
                                    @for (tag of program.tags; track $index) {
                                    <ion-chip color="primary" size="small">{{ tag }}</ion-chip>
                                    }
                                </div>
                                }
                            </ion-label>
                        </ion-item>

                        <ion-item-options side="start">
                            <ion-item-option color="primary" (click)="presentAssignProgramPopover(program)">
                                <ion-icon slot="icon-only" name="person-add"></ion-icon>
                            </ion-item-option>
                        </ion-item-options>

                        <ion-item-options side="end">
                            <ion-item-option color="danger" (click)="deleteProgram(program.id)">
                                <ion-icon slot="icon-only" name="trash"></ion-icon>
                            </ion-item-option>
                        </ion-item-options>
                    </ion-card>
                </ion-item-sliding> -->
                }
            </ion-list>
        </ng-container>

        <ng-container *ngSwitchCase="'templates'">
            <ion-list>
                @for (template of templates; track template.exercises.length) {
                <ion-item-sliding>
                    <ion-item [button]="true" (click)="presentTemplateActionSheet(template)">
                        <ion-label>
                            <h2> {{ template.name ?? ('template' | translate) }} ({{ template.exercises.length
                                }})
                            </h2>
                            <ion-note>
                                @for (exercise of template.exercises.slice(0, 3); track $index) {
                                {{ exercise.name }}{{ !$last ? ', ' : '' }}
                                } @empty {
                                {{ 'blank_template' | translate }}
                                }
                            </ion-note>
                        </ion-label>
                    </ion-item>
                    <ion-item-options side="start">
                        <ion-item-option color="primary" (click)="presentAssignTemplatePopover(template)">
                            <ion-icon slot="icon-only" name="person-add"></ion-icon>
                        </ion-item-option>
                    </ion-item-options>
                    <ion-item-options side="end">
                        <ion-item-option color="danger" (click)="deleteTemplate(template.id)">
                            <ion-icon slot="icon-only" name="trash"></ion-icon>
                        </ion-item-option>
                    </ion-item-options>
                </ion-item-sliding>
                }
            </ion-list>
        </ng-container>

    </div>
</ion-content>